import React, { useState, useEffect } from 'react';
import LoginPage from './LoginPage';
import TextHumanizer from './TextHumanizer';

export default function App(){ 
  const [user, setUser] = useState(null);

  useEffect(()=>{
    const email = localStorage.getItem('th_user_email');
    const token = localStorage.getItem('th_user_token');
    if(email && token){
      setUser({ email, token });
    }
  },[]);

  function handleLogin(email, token){
    localStorage.setItem('th_user_email', email);
    localStorage.setItem('th_user_token', token);
    setUser({ email, token });
  }

  function handleLogout(){
    localStorage.removeItem('th_user_email');
    localStorage.removeItem('th_user_token');
    setUser(null);
  }

  if(!user) return <LoginPage onLogin={handleLogin} />;
  return <TextHumanizer userEmail={user.email} onLogout={handleLogout} />;
}

